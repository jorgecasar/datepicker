<link rel="import" href="../js/lib/polymer/polymer.html">
<link rel="import" href="d-picker-day.html">
<link rel="import" href="d-picker-day-empty.html">
<dom-module id="d-picker-days">
  <template strip-whitespace>
    <style>
      :host {
        display: flex;
        flex-wrap: wrap;
      }
    </style>
  </template>
  <script>
    Polymer({
      is: "d-picker-days",
      properties: {
        date: Date,
        showcd: String
      },
      attached: function() {
        this.addDays();
      },
      addEmptyDays: function(date) {
        for(let i = 0; i < date.getDay(); i++) {
          const empty = document.createElement("d-picker-day-empty");
          Polymer.dom(this.root).appendChild(empty);
        }
      },
      addDays: function() {
        const month = this.date.getMonth() + 1;
        const year = this.date.getFullYear();
        const firt_date = new Date(month + '/1/' + year);
        this.addEmptyDays(firt_date);
        let current_date = firt_date;
        let current_month = firt_date.getMonth();
        while(current_month == firt_date.getMonth()) {
          const day = document.createElement("d-picker-day");
          Polymer.dom(day).setAttribute("number", current_date.getDate());
          if(current_date.getDate() == this.date.getDate()
            && this.showcd == 'true') {//TODO: if showcd == Boolean, it fail
            $(day).css("background-color", "#ffd97d");
          }
          Polymer.dom(this.root).appendChild(day);
          this.updateStyles();
          current_date = this.incremetOneDay(current_date);
          current_month = current_date.getMonth();
        }
      },
      incremetOneDay: function(date) {
        var result = new Date(date);
        result.setDate(date.getDate() + 1);
        return result;
      }
    });
  </script>
</dom-module>
